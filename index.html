<canvas id="canvas" width="300" height="400" style="display:none;"></canvas>
<p id="status">準備中...</p>

<script>
  async function main() {
    await liff.init({ liffId: "2008850895-GKh4kFcG" });

    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "user" },
      audio: false
    });

    const video = document.getElementById("video");
    video.srcObject = stream;

    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    document.getElementById("status").innerText = "フレーム取得中";

    setInterval(() => {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      const imageBase64 = canvas.toDataURL("image/jpeg");
      console.log(imageBase64.substring(0, 50)); // 確認用
    }, 1000);
  }

  main();
</script>
