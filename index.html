<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>姿勢撮影</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>

<h3 id="status">準備中...</h3>

<video id="video" autoplay playsinline width="300"></video>
<canvas id="canvas" width="300" height="400"
        style="position:absolute; top:80px; left:0;"></canvas>

<script>
async function main() {
  try {
    await liff.init({ liffId: "2008850895-GKh4kFcG" });

    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "user" },
      audio: false
    });

    const video = document.getElementById("video");
    video.srcObject = stream;

    document.getElementById("status").innerText = "カメラ取得完了";

    // 描画テスト（骨格の代わり）
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = "red";
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(150, 50);
      ctx.lineTo(150, 200);
      ctx.stroke();
      requestAnimationFrame(draw);
    }

    draw();

  } catch (e) {
    document.getElementById("status").innerText = "エラー: " + e.name;
    console.error(e);
  }
}

main();
</script>

</body>
</html>
